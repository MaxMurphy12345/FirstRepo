This is extracted from git
